From 386ad8de09b349baf7c89683f2045bf480ddbb5f Mon Sep 17 00:00:00 2001
From: Shareef Ali <shareefalis@gmail.com>
Date: Sun, 4 Mar 2012 19:09:08 -0500
Subject: [PATCH 3/4] epicmtd: free unused mmap memory (PMEM) from older
 samsung powervr driver for gingerbread. result: 13 mb
 free

Change-Id: I4e6f60412d52e6d3748fd827cc12fe0f24036aaf

diff --git a/Kernel/arch/arm/configs/cyanogenmod_epicmtd_defconfig b/Kernel/arch/arm/configs/cyanogenmod_epicmtd_defconfig
index 8b7da71..f3c89b4 100644
--- a/Kernel/arch/arm/configs/cyanogenmod_epicmtd_defconfig
+++ b/Kernel/arch/arm/configs/cyanogenmod_epicmtd_defconfig
@@ -995,14 +995,14 @@ CONFIG_BLK_DEV_RAM_SIZE=8192
 # CONFIG_MG_DISK is not set
 CONFIG_MISC_DEVICES=y
 # CONFIG_AD525X_DPOT is not set
-CONFIG_ANDROID_PMEM=y
+# CONFIG_ANDROID_PMEM=y
 
 #
 # Reserved memory configurations
 #
-CONFIG_ANDROID_PMEM_MEMSIZE_PMEM=8192
-CONFIG_ANDROID_PMEM_MEMSIZE_PMEM_GPU1=3072
-CONFIG_ANDROID_PMEM_MEMSIZE_PMEM_ADSP=6144
+#CONFIG_ANDROID_PMEM_MEMSIZE_PMEM=8192
+#CONFIG_ANDROID_PMEM_MEMSIZE_PMEM_GPU1=3072
+#CONFIG_ANDROID_PMEM_MEMSIZE_PMEM_ADSP=6144
 # CONFIG_ICS932S401 is not set
 # CONFIG_ENCLOSURE_SERVICES is not set
 # CONFIG_KERNEL_DEBUGGER_CORE is not set
diff --git a/Kernel/arch/arm/mach-s5pv210/mach-victory.c b/Kernel/arch/arm/mach-s5pv210/mach-victory.c
index a1e2e5c..03264b2 100644
--- a/Kernel/arch/arm/mach-s5pv210/mach-victory.c
+++ b/Kernel/arch/arm/mach-s5pv210/mach-victory.c
@@ -374,10 +374,6 @@ static struct s3cfb_lcd nt35580 = {
 		(CONFIG_FB_S3C_NUM_OVLY_WIN * \
 		 CONFIG_FB_S3C_NUM_BUF_OVLY_WIN)))
 #define  S5PV210_VIDEO_SAMSUNG_MEMSIZE_JPEG (5012 * SZ_1K)
-#define  S5PV210_VIDEO_SAMSUNG_MEMSIZE_PMEM (5550 * SZ_1K)
-#define  S5PV210_VIDEO_SAMSUNG_MEMSIZE_GPU1 (3300 * SZ_1K)
-#define  S5PV210_VIDEO_SAMSUNG_MEMSIZE_ADSP (1500 * SZ_1K)
-#define  S5PV210_VIDEO_SAMSUNG_MEMSIZE_TEXTSTREAM  (3000 * SZ_1K)
 static struct s5p_media_device victory_media_devs[] = {
 	[0] = {
 		.id = S5P_MDEV_FIMD,
@@ -428,34 +424,6 @@ static struct s5p_media_device victory_media_devs[] = {
 		.memsize = S5PV210_VIDEO_SAMSUNG_MEMSIZE_JPEG,
 		.paddr = 0,
 	},
-	[7] = {
-		.id = S5P_MDEV_PMEM,
-		.name = "pmem",
-		.bank = 0,
-		.memsize = S5PV210_VIDEO_SAMSUNG_MEMSIZE_PMEM,
-		.paddr = 0,
-	},
-	[8] = {
-		.id = S5P_MDEV_PMEM_GPU1,
-		.name = "pmem_gpu1",
-		.bank = 0,
-		.memsize = S5PV210_VIDEO_SAMSUNG_MEMSIZE_GPU1,
-		.paddr = 0,
-	},	
-	[9] = {
-		.id = S5P_MDEV_PMEM_ADSP,
-		.name = "pmem_adsp",
-		.bank = 0,
-		.memsize = S5PV210_VIDEO_SAMSUNG_MEMSIZE_ADSP,
-		.paddr = 0,
-	},		
-        [10] = {
-                .id = S5P_MDEV_TEXSTREAM,
-                .name = "s3c_bc",
-                .bank = 1,
-                .memsize = S5PV210_VIDEO_SAMSUNG_MEMSIZE_TEXTSTREAM,
-                .paddr = 0,
-        },
 };
 
 static struct regulator_consumer_supply ldo3_consumer[] = {
-- 
1.7.5.4

